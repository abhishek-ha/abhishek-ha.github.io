function ShowLoding(e){e?($("#otpapp").hide(),$("#Thankyouformdiv").hide(),$("#Lodingdivid").show(),openmodalcallback()):(closemodalcallback(),$("#Lodingdivid").hide())}function openmodalcallback(){document.getElementById("callbackpopup").style.display="block"}function closemodalcallback(){document.getElementById("callbackpopup").style.display="none"}function startTimer(){var e=document.getElementById(timerFName).innerHTML.split(/[:]+/),t=e[0],a=checkSecond(e[1]-1);59==a&&(t-=1),!(t<0)&&(document.getElementById(timerFName).innerHTML=t+":"+a,setTimeout(startTimer,1e3))}function checkSecond(e){return e<10&&e>=0&&(e="0"+e),e<0&&(e="59"),e}!function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.async=!0,e.src="https://checkout.razorpay.com/v1/checkout.js",e.charset="UTF-8",e.setAttribute("crossorigin","*"),t.parentNode.insertBefore(e,t)}(),$("<style type='text/css'>.preloader1 { top:0; bottom:0; left:0; right:0; position:absolute; margin:auto; width: 100px; height: 100px; border-radius: 100%; border: 4px solid white; border-top: 4px solid #0f5fc2; order-right: 4px solid #0f5fc2; border-bottom: 4px solid #0f5fc2; -webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;}@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }}@-webkit-keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style>").appendTo("head"),$("body").append("<div style=' background-color: rgba(0, 0, 0, 0.5);'>        <style>            .modal-body {                padding: 2px 16px;            }            .modal-content1 {                position: absolute;                background-color: rgba(0, 0, 0, 0.5);                margin: auto;                padding: 0;                border: 0px solid #888;                width: 100%;                height: 100%;                box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);                animation-name: animatetop;                animation-duration: 0.4s            }            @keyframes animatetop {                from {                    top: -300px;                    opacity: 0                }                to {                    top: 0;                    opacity: 1                }            }            .card {                width: 430px;                border: none;                height: 330px;                box-shadow: 0px 5px 20px 0px #6F1667;                z-index: 1;                display: flex;                justify-content: center;                align-items: center            }            .card h6 {                color: #6F1667;                font-size: 20px            }            .inputs input {                width: 100px;                height: 40px            }            input[type=number]::-webkit-inner-spin-button,            input[type=number]::-webkit-outer-spin-button {                -webkit-appearance: none;                -moz-appearance: none;                appearance: none;                margin: 0            }.heightwidth1{   padding: 0px;}            .form-control:focus {                box-shadow: none;                border: 2px solid #808080            }            .validate {                border-radius: 20px;                height: 40px;                background-color: green;                border: 1px solid green;                width: 100%            }            .content a {                color: #D64F4F;                transition: all 0.5s            }            .content a:hover {                color: #6F1667            }        </style>        <div id='callbackpopup' class='modal'>            <div class='modal-content1'>               <div id='otpapp' class='modal-dialog-centered'>                      <div class='container height-100 d-flex justify-content-center align-items-center'>                        <div class='position-relative'>                            <div class='card p-2 text-center'>                                <h6>  Please enter the one time password  <span class='px-4 ml-3' onclick='closemodalcallback()'><i class='fa  fa-times' aria-hidden='true'></i></span> <br> </h6>                                <div> <span> sent to +91******</span> <small id='mobilenotext1'>4343</small> </div>                                <div id='otp' class='inputs d-flex flex-row justify-content-center mt-2'> <input                                        class='m-2 text-center form-control rounded heightwidth1' type='number' id='input1'                                        maxlength='6' />                                </div>                                <span> Time Left: <small id='timer1'>00:00</small></span>                                <span style='color: red;' id='message'></span>                                <div class='mt-4'> <button id='VarifyOTPbtn'                                        class='btn btn-danger px-4 validate'>Validate</button>                                </div>                                <div class='mt-3 content d-flex justify-content-center align-items-center'> <span>Didn't                                        get the                                        code &nbsp</span> <a href='javascript:OpenOTPPopup()'                                        class='text-decoration-none ms-3'><small                                            id='otptextFeild1'>Resend(1/3)</small></a>                                </div>                            </div>                        </div>                    </div>                   </div></div> <div class='modal-dialog modal-dialog-centered modal-lg' style='display: none;' id='Thankyouformdiv'>                    <div style='background-color:white;' class='modal-content'>                        <div class='modal-header'>                            <h5 class='modal-title text-center' id='exampleModalLabel'> </h5>                            <button type='button' class='close' onclick='closemodalcallback()'>                                <span aria-hidden='true'>&times;</span>                            </button>                        </div>                        <div class='modal-body'>                            <div class='row'>                                <div class='pt-5'>                                    <h3 class='text-center' style='font-size:23px;'> Thank you for choosing us. We assure you to take care of Your Health. !!</h3>                                    <p class='text-center pt-2' id='callbackAmessageId1'><b>Please Log in with your credentials on our Portal or App and start using the benefits.</b></p>                                    <div class='col-md-8  text-center mx-auto'>                                        <button type='submit' style='background-color: green;' data-dismiss='modal' value='OK'                                            class=' btn-class  pgreenbtn' onclick='closemodalcallback()' >                                            Ok </button>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div></div> </div></div> <div style='display: none;' id='Lodingdivid' class='preloader1'></div>");var ProductApiBaseUrl="https://live.healthassure.in/ProductApi/",RenewalOPDObj=null,timerFName="timer1";function RenewalOPDPlan(e,t,a,n,o){return new Promise(function(a,i){ShowLoding(!0),$("#input1").val(""),$.ajax({type:"POST",url:ProductApiBaseUrl+"api/OPDPlans/RenewalOPDPlanRequest",data:JSON.stringify({Username:e,PlanCode:t,CouponCode:n,PolicyNo:o,IsOTPVarification:!0}),dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json",ApiKey:"joxNjM0MjE2NDQ5fQ.nk2tgCC1NRAbaperiPWQXXoNgybL27zdN3T4dC5L-ak"},success:function(e){if(e.status){RenewalOPDObj=e,$("#otpapp").show(),ShowLoding(!1),openmodalcallback(),$("#mobilenotext1").html(e.results.user.mobileNo.slice(e.results.user.mobileNo.length-4)),$("#"+timerFName).html("00:00");var t=e.results.otpDetails.otpExpiryTime,n=Math.floor(t/60);t-=60*n,$("#"+timerFName).html(n+":"+t),startTimer(),$("#otptextFeild1").html(" Resend OTP"),a(e)}else alert(e.message),console.warn(e),i("Error Creating transaction Id from HealthAssure side")},error:function(e){console.warn(e),i(e)}})})}function RenewalOPDPlanRequest(e){RenewalOPDPlan("","","","",e)}function OpnOPDPaymentPopUp(e,t){return new Promise(function(a,n){var o={Accept:"application/json","Content-Type":"application/json",ApiKey:"joxNjM0MjE2NDQ5fQ.nk2tgCC1NRAbaperiPWQXXoNgybL27zdN3T4dC5L-ak"};if(e.status){var i={key:e.results.razorpayKey,amount:e.results.transaction.amountIncludingGST,currency:e.results.razorpayOrder.currency,name:"HealthAssure",description:e.results.user.planName,image:t+"image/logo/halogo.png",order_id:e.results.razorpayOrder.id,handler:function(i){try{ShowLoding(!0)}catch{}$.ajax({type:"POST",url:t+"api/OPDPlans/RenewalOPDPlanConformation",data:JSON.stringify({TransactionId:e.results.razorpayOrder.receipt,Message:"Payment Success",RefId:i.razorpay_payment_id,OrderId:e.results.razorpayOrder.id,Signature:i.razorpay_signature,Status:"Success"}),dataType:"json",headers:o,success:function(e){if(e.status){a(e);try{ShowLoding(!1)}catch{}}else console.warn(e),n("Error from Buy OPD Plan Conformation")},error:function(e){console.warn(e),n(e)}})},prefill:{name:e.results.user.name,email:e.results.user.emailId,contact:"91"+e.results.user.mobileNo},notes:{transactionId:e.results.razorpayOrder.receipt,address:"Registered Office : 1st Floor, Excom House, North Wing, 7 Saki-vihar Road, Sakinaka, Andheri(E), Mumbai-400 072"},theme:{color:"#3399cc"},modal:{ondismiss:function(){try{ShowLoding(!1),userClosePaymentPopup()}catch{}}}},r=new Razorpay(i);r.on("payment.failed",function(e){console.warn(e.error)}),r.open()}else console.warn(e),n("Error Creating transaction Id from HealthAssure side")})}function userClosePaymentPopup(){closemodalcallback()}function VarifyOTPforValidation(e,t){return new Promise(function(a,n){$.ajax({type:"POST",url:ProductApiBaseUrl+"api/User/VerifyMobileNo",dataType:"json",data:JSON.stringify({MobileNumbar:t,OTP:e}),headers:{Accept:"application/json","Content-Type":"application/json",ApiKey:"joxNjM0MjE2NDQ5fQ.nk2tgCC1NRAbaperiPWQXXoNgybL27zdN3T4dC5L-ak"},success:function(e){console.warn(e.message),e.status?a(e):n(e)},error:function(e){console.warn(e),n(e)}})})}function GetOPDPlanForRenewal(e){return new Promise(function(t,a){ShowLoding(!0),$.ajax({type:"GET",url:ProductApiBaseUrl+"api/UserOPDPlans/GetOPDPlanForRenewal?policyNo="+e,dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json",ApiKey:"joxNjM0MjE2NDQ5fQ.nk2tgCC1NRAbaperiPWQXXoNgybL27zdN3T4dC5L-ak"},success:function(e){console.warn(e.message),ShowLoding(!1),e.status?t(e):a(e)},error:function(e){ShowLoding(!1),console.warn(e),a(e)}})})}$("#VarifyOTPbtn").click(function(){VarifyOTPforValidation(document.getElementById("input1").value,RenewalOPDObj.results.user.mobileNo).then(function(e){$("#VarifyOTPbtn").html("Verified"),$("#message").html(""),OpnOPDPaymentPopUp(RenewalOPDObj,ProductApiBaseUrl).then(function(e){window.open("thankyou.html","_parent")}).catch(function(e){$("#message").html(e.message)}),$("#otpapp").hide()}).catch(function(e){$("#message").html(e.message)})});